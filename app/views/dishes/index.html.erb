<div class="page-container" align="center">
  <div class="filters-section <%= 'hidden' if flash[:notice].present? %>">
    <!-- your existing filter-card here -->
    <div class="filter-card shadow-lg">
      <% unless action_name == "my_reviews" %>
        <div class="filter-header">
          <h2>üçΩÔ∏è Discover Your Next Favourite Dish</h2>
        </div>

        <%= form_with url: dishes_path, method: :get, local: true, html: { autocomplete: "off", class: "filter-form" } do %>
          <div class="filter-group">
            <% selected_city_id = params[:city_id].presence || @restaurant&.city_id %>
            <%= select_tag :city_id,
                  options_for_select(
                    @cities.map { |c| [c.name, c.id] },
                    selected_city_id
                  ),
                  include_blank: "üåÜ All Cities",
                  class: "filter-input"
              %>
          </div>

          <div class="filter-group">
            <%= text_field_tag :dish_name, params[:dish_name], placeholder: "üçõ Dish Name", class: "filter-input" %>
          </div>

          <div class="filter-group">
            <%= text_field_tag :restaurant_name, params[:restaurant_name], placeholder: "üè® Restaurant Name", class: "filter-input" %>
          </div>

          <%= submit_tag "üîç Apply Filters", class: "btn-apply" %>
        <% end %>
        <%= link_to "‚ûï Add Review", new_dish_path, class: "btn-action" %>
      <% end %>
    </div>
  </div>
  <div class="table-wrapper">
    <table class="styled-table">
      <thead>
        <tr>
          <th>Restaurant</th>
          <th>Dish</th>
          <th>
            <% new_direction =
                params[:sort_column] == "rating" && params[:sort_direction] == "asc" ? "desc" : "asc" %>
            <%= link_to url_for(params.permit!.to_h.merge(sort_column: "rating", sort_direction: new_direction)),
                        class: "sort-link #{'active' if params[:sort_column] == 'rating'}" do %>
              ‚≠ê Rating
              <span class="arrow">
                <% if params[:sort_column] == "rating" %>
                  <%= params[:sort_direction] == "asc" ? "‚Üë" : "‚Üì" %>
                <% else %>
                  ‚áÖ
                <% end %>
              </span>
            <% end %>
          </th>
          <th>üí¨ Comments</th>
          <th>üèôÔ∏è City</th>
          <th> Actions </th>
        </tr>
      </thead>

      <tbody>
        <% @dishes.each do |dish| %>
          <tr>
            <td><%= link_to dish.restaurant&.name, dishes_restaurant_path(dish.restaurant), class: "restaurant-link" %></td>
            <td><%= dish.name %></td>
            <td><%= dish.rating %></td>
            <td><%= dish.comments %></td>
            <td><%= dish.restaurant.city.name %></td>
            <td>
              <% if dish.user == current_user %>
                <%= link_to edit_dish_path(dish), class: "btn btn-sm btn-outline-primary", title: "Edit" do %>
                  <i class="fa fa-edit"></i>
                <% end %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <div class="actions">
    <%= link_to "‚ûï Add Review", new_dish_path, class: "btn-action" %>
    <%= link_to "‚¨ÖÔ∏è Back to List", dishes_path, class: "btn-secondary" %>
  </div>

  <div class="pagination" align="center">
    <%= paginate @dishes %>
  </div>
</div>
